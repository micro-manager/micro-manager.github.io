== XY Stage ==

<table>
<tr><td>
'''Summary:'''</td><td>XY Stage - brushless DC motor controller BBD 102</td></tr>
<tr><td>
'''Author:'''</td><td>Nenad Amodaj</td></tr>
<tr><td>'''License:'''</td><td>BSD</td></tr> 
<tr><td>'''Platforms:'''</td><td>All platforms (uses serial port)</td></tr>
<tr><td>'''Devices:'''</td><td>XYStage</td></tr>
<tr><td>'''Example Config File:'''</td><td>See below</td></tr>
</table>

XY stage device adapter that works with BBD 102 brushless DC motor contoroller[http://www.thorlabs.us/NewGroupPage9.cfm?ObjectGroup_ID=5066] and supports high speed motorized scanning stage MLS 203 [http://www.thorlabs.us/NewGroupPage9.cfm?ObjectGroup_ID=4653].

=== Setup ===
This adapter requires only a serial serial port (RS-232). One port should be reserved for this stage and initialized with the following parameters:

BaudRate: 115200

Handshaking: Off

Parity: None

StopBits: 1

(all other micro-manager port parameters can be left with defaults)

The only parameter that is required for configuration of the stage is the name of the serial port (e.g. COM2) attached to the controller.

=== Using the stage ===
If the port was correctly set and connected in the previous step, micro-manager will load the stage adapter at startup. The stage uses absolute XY coordinates and any positions recorded in micro-manager will always correspond to the same physical location. However, because of this feature, each time we power-up this stage needs to be "homed" before sending any commands. If we try to move it before homing, error message will pop up. Homing is not automatic on startup because during this procedure stage moves to its limits and in may cause one of the objectives to hit the stage frame, if the objective turret is left high enough. This is an issue with any XY stage and the user always needs to make sure that objective turret is in the safe position before homing.

==== Home procedure ====
The stage needs to be homed once after each power-up. Homing is not necessary if we just exit and re-start the software without powering down. There are three ways to home the stage:

'''Using Calibrate command'''

Open Stage Position List dialog and press "Calibrate" button (menu: Tools | XY List...).

'''Using script'''

Copy the following script, paste it into the Script Editor (menu: Tools | Script Panel...) and press "Run" button.

 <nowiki>
// home XY Stage
gui.message("Homing started...");
xyStage = mmc.getXYStageDevice();
mmc.home(xyStage);
x = mmc.getXPosition(xyStage);
y = mmc.getYPosition(xyStage);
gui.message("Done! Home position [um]: " + x + ", " + y);</nowiki>

This script can be saved and stored in the Script-Shortcut list for future use.

'''Using special micro-manager startup script'''
