== ASI Stage ==

<table><tr><td>
'''Summary:'''</td><td>For ASI MS2000 controllers, including stages (XY, Z, piezo) and CRISP autofocus</td></tr>
<tr><td>'''Author:'''</td><td>Jizhen Zhao, based on Nenad Amodaj's Prior adapter.  CRIFF, CRISP, and AZ100 Turret by Nico Stuurman.  Currently maintained by Nico Stuurman</td></tr>
<tr><td>'''License:'''</td><td>LGPL</td></tr> 
<tr><td>'''Platforms:'''</td><td>All platforms (uses serial port)</td></tr>
<tr><td>'''Devices:'''</td><td>XYStage, ZStage, CRIF, CRISP, AZ100 Turret, LED</td></tr>
<tr><td>'''Example Config File:'''</td><td>None</td></tr>
</table>

NB: there is a separate device adapter for modular TG1000 "Tiger" controllers [[ASITiger]].

Controls ASI's stage controllers such as the MS2000 [http://www.asiimaging.com/products/controllers/ms-2000-wk-multi-axis-stage-controller/], [http://www.asiimaging.com/products/controllers/rm-2000-rack-mount-stage-controller/].  Depending on installed hardware, the controller works with XY, Z stages (linear and piezo) and the CRISP or CRIFF autofocusing modules.  In Micro-manager, each stage or device connected to the controller is added as a separate device assigned to the appropriate serial port (even though all devices might actually be attached to one and the same controller and this controller is attached to the PC through a serial cable).  

The MS2000 and relatives can control two different Z stages, a normal one ("Z"), and a piezo Z stage which can either be called "Z", or - if a normal motorized stage is installed "F".  AS of Micro-Manager version 1.2.7, you can instantiate multiple ASI Z-stages, which will take a pre-initialization property 'Axis' that can be set to either "Z" or "F" (do not instantiate the same axis twice!).

The piezo Z stage can be set up to receive trigger signals from many cameras (see documentation on Micro-Manager's [[Hardware-based_synchronization]] feature). A BNC cable is connected from the camera's TTL output to the MS2000 controller's piezo trigger input.  By synchronizing Z slices with camera exposures, you can acquire very fast Z stacks. By default, triggered Z stacks are limited to 50 slices: if you want to acquire Z stacks with more slices, please [http://www.asiimaging.com/contact-us/ contact ASI directly] for a firmware update.

CRIFF [http://www.asiimaging.com/products/focus-stabilization/criff-continuous-reflective-interface-feedback-focus-system/] was ASI's original autofocus product, and has been replaced by the CRISP autofocus system [http://www.asiimaging.com/products/focus-stabilization/crisp-autofocus-system/].  In both, the user can cycle of several states states (laser idle, laser on, calibrate, lock/unlock, laser off) by pressing the middle "@" button on the controller for 6 seconds (see the CRIFF manual [http://www.asiimaging.com/ftp2asi/Manuals/CRIFF%20Manual.pdf]).  Most of these state changes are implemented in the CRIFF and CRISP adapters.  In general, it is easiest to first calibrate the CRIFF/CRISP by hand and then use Micro-manager to lock and unlock the CRIFF/CRISP.

As of ASI controller version 8.0 (called the 'WK Whizkid'), the build-in USB connection is actually a USB to serial converter.  You can find drivers for Windows, Mac OS X, and linux at the [http://www.silabs.com/products/mcu/Pages/USBtoUARTBridgeVCPDrivers.aspx silabs] website.

The DIP switches on the back on recent controllers control the baudrate for both the real serial and the USB to serial ports on the controller.  See your manual for details.

The following is an incomplete list of properties currently implemented in the Micro-Manager ASI stage adapter:
<table>
<tr><th>Property</th><th>Description</th></tr>
<tr><td><b>Stepsize</b> (for X and Y in um)</td><td>  Read-only property.</td></tr>
<tr><td><b>WaitCycles</b></td><td>  Sets how long the controller will wait after reaching a position before clearing its 'busy' signal.  Number equals the number of 'servo' cycles (80 ms per cycle on XYstage, 120 ms per cycle on XYZ stages, etc..).  Range: 0-255</td></tr>
<tr><td><b>Speed</b> (for both X and Y)</td><td>Sets the maximum speed at which the stage will move in mm/sec.  Hardware maximum is 7.5 mm/s for 6.5 mm pitch leadscrews</td></tr>
<tr><td><b>Backlash</b> (for both X and Y, in mm)</td><td>Makes the controller approach the target always from the same direction, starting the set number of mm away from the target position</td></tr>
<tr><td><b>Error</b> (for both X and Y, in nm)</td><td>When the difference between the current position (as read from the encoders) is larger than this number, the controller will re-engage the motors to reach the target position</td></tr>
<tr><td><b>Finish Error</b> (for both X and Y in nm)</td><td>This setting controls at what difference between the target and current position the controller will stop trying to get closer to the target.  Similar to Error, but this one applies to ongoing movements.</td></tr>
<tr><td><b>OverShoot</b> (for both X and Y)</td><td>Inverse of Backlash.  Setting this might help to increase stability of the stage after a movement</td></tr>
<tr><td><b>MotorOnOff</b> (for  both X and Y)</td><td>  Switches motor On or Off.</td></tr>
<tr><td><b>NrMoveRepetition</b></td><td> Number of times the stage sill approach the same position.  Setting this to 0 will cause one approach.  Settings this to 2 or 3 can increase the accuracy with which a position is reached.</td></tr>
</table>


{{Devices_Sidebar}}
