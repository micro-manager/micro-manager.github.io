<table><tr><td  valign=top >
'''Summary:'''</td><td>Interfaces with Andor laser combiner</td></tr>
<tr><td valign=top>'''Author:'''</td><td>Pariksheet Nanda (Andor product support)<br>
Glenn Jolleys is the Andor Laser Combiner Developer</td></tr>
<tr><td  valign=top >'''License:'''</td><td>BSD</td></tr> 
<tr><td  valign=top >'''Platforms:'''</td><td>Windows (No Mac or Linux driver available)</td></tr>
<tr><td  valign=top >'''Devices:'''</td><td>Andor laser combiners: ALC-401, ALC-501, ALC-601</td></tr>
</table>

----

== Andor Drivers (only required for non-Andor computers) ==

NOTE: Andor completes the steps described in this section in their factory.
If you are setting up an Andor laser combiner on a new computer, only then do you need to follow this document.

The tested platform for installing the Andor laser launch driver is Windows XP Professional 32-bit.
It may be possible to use Windows 7 32-bit, but using it at the moment is beyond the scope of this document.

Specific driver versions are required.
Since the manufacturer websites offer later versions of these drivers, please instead use your Andor iQ CD-ROM and install only in the following order.

When you start Windows XP, ignore the Found New Hardware Wizard.
Also when installing, ignore the driver requests to restart your computer.

# (Optional for testing) Dongle Driver
# Andor iQ 1.10.2
#* Necessary because iQ installs the driver to recognize the DeVaSys microcontroller in the combiner
#* (Optional for testing) iQ would also serve to test that communication and control of the combiner is possible
# Measurement Computing DAC card driver
#* Recognizes the Andor Precision Control Unit (PCU) box which controls the laser combiner Acousto-Optic Tunable Filter (AOTF)
# Prolific USB to RS232 driver
# Restart your PC
# Let Windows Found New Hardware wizard finish for all hardware
# Start menu > Measurement Computing > InstalCal, to register the PCU DAC card
#* Running InstaCal creates a new configuration file which is used by iQ
#* Simply running the program once and closing it creates the file
#* Do not delete the DEMO board.
#* Two boards should exist, the DEMO board #0 and your installed board #1
# Start Menu > Andor Bioimaging > ConfigurationManager
#* Create a new configuration with a Kinetic Dummy Camera and the Andor laser combiner
# Remap the USB-to-Serial COM ports in your Device Manager to 201-204
#* iQ reserves these specific port numbers for the combiner
#* (Right-click) on My Computer > Manage to invoke the Device Manager
#* See screenshots below to change COM ports.  By unplugging the USB cable from the front of the Andor combiner we know that Windows has enumerated the COM ports for the lasers from COM 7 to COM 10 (since these port numbers disappear from the Device manager when we unplug the combiner and reappear when we plug it back in) [[Image:AB-1-com-ports.png|frame|center||Step 1:  After restarting Windows with drivers freshly installed, the device manager can list the COM ports of the laser combiner out of order i.e. it orders alphabetically instead of numerically. In this case COM10 should not be made 201, but COM7 would be 201]] [[Image:AB-2-reassign-com-port.png|frame|center||Step 2:  Process of reassigning the COM port from COM 7 to COM 201.  (Right-click) on the port > Properties > Port Settings (tab) > Advanced > change the COM port number]] [[Image:AB-3-reassigned-scan.png|frame|center||Step 3:  After 201-204 have been resassigned, click on scan for hardware changes to refresh the window]] [[Image:AB-4-new-ports.png|frame|center||Step 4:  Result of COM port changes]]
# (Optional for testing) Now start iQ with your new laser combiner configuration and test

== Installing the Device Adapter ==
* Get the Andor SDK. Email your sales representative for it, and state you'll use it for uManager. It's a zip file you should decompress to a folder on  your C: drive. Copy the address (something like C:\Andor\AND_SDK). Now, right click the My Computer icon on the desktop or start menu, click properties and on the advanced tab choose Environment variables. On the system variables list, find "Path" or "PATH" and click edit. DO NOT DELETE ANYTHING. Just add ;C:\YOURFOLDER on the end of the line on the edit window. Of course, remember to change the folder to where you unzipped the SDK. Also, remember to include the semi-colon (;) or you might break something on your windows installation.
Now, reboot your computer.
* Get the latest nightly build to run the Andor laser combiner in uManager.
* When configuring your hardware setup, remember to add the AndorLaserCombiner and AndorLaserCombiner Piezostage (if you have a piezostage). Also, the configuration wizard will ask if you have a multiport unit present. If you have a FRAPPA unit or TIRF setup, you do and should set it to "1" (true). Other than those cases you probably don't have it, set it to "0" (false).

== Resources ==
=== Laser Combiner questions ===
For contacting Andor product support regarding any questions, see under "Support" for your location - http://www.andor.com/contact_us/default.aspx
=== Development support ===
Please liaison with Micro-Manager developers to contact the Andor software team


[[User:P.nanda|P.nanda]] 05:03, 14 April 2010 (UTC)
