{|
|valign="top"|'''Summary:'''
|Interfaces with Andor laser combiner
|-
|valign="top"|'''Author:'''
|Karl Hoover, UCSF - µManager device adapter
|-
|valign="top"|'''Maintainer:'''
|Pariksheet Nanda, Andor - this documentation and µManager device adapter
|
|-
|valign="top"|'''Contributors:'''
|Ed Simmons, ES Imaging - patch for GUI TTL outputs
|-
|
|Pedro Almada, documentation fixes
|-
|valign="top"|'''License:'''
|BSD
|-
|valign="top"|'''Platforms:'''
|Windows XP 32bit
|-
|
|Windows 7 32bit and 64bit
|-
|
|(No Mac or Linux driver available)
|-
|valign="top"|'''Devices:'''
|ALC-401
|-
|
|ALC-501
|-
|
|ALC-601
|}
----



== Getting Started ==
* You need to download a copy of the Andor Laser Combiner SDK (ALC_SDK).  It is not publicly available.  To gain access to it, register/sign-into your MyAndor web account on the Andor homepage, click on Software > Downloads, uncheck the "Display only files I have access to", select "DRIVER: Andor ALC SDK 2.0" and request access.
* '''ALC_SDK 2.0 is the current version as of July 29, 2011'''

{| style="background-color:#CCFFFF;" cellpadding="10" cellspacing="0"
|valign="top"| '''Note:'''
| The rest of this guide assumes you have a computer preconfigured with drivers, such as the computer Andor sells.  If, instead, you have a non-Andor computer please read the [[#Appendix|appendix]] to install the drivers and map the COM ports.
|}



== Installing the Device Adapter ==
=== Setup the ALC_SDK ===
# [http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=11895 Download] and install VC 2008 redistributable.  The ALC_SDK library requires this.
# Copy the ALC_SDK library from the ALC_SDK zip file (under .\ALC_REV_SDK\Libraries) to your Micro-Manager folder (e.g. C:\Program Files\Micro-Manager-1.4):
#* For 32-bit you would need only AB_ALC_REV.dll
#* For 64-bit you would need AB_ALC_REV64.dll and usb2i2cio64.dll



=== Configuring Micro-Manager ===
* Support for the AndorLaserCombiner was introduced in Micro-Manager 1.3.47
* During hardware setup from Tools > Hardware Configuration Wizard...
** You must add the '''AndorLaserCombiner'''
** Add '''AndorLaserCombiner Piezostage''' if your system uses Andor's analog control for piezo Z.  Generally, confocal systems have this configuration.  If you are unsure if you have this, look at the front of your Andor Precision Control Unit (PCU)- if you see a BNC connected from A5 to your Piezo Z controller, you should enable this option.
** Select "1" (true) if you have the 3 fiber optic multiport unit (MPU) controller attachment on the front of your laser combiner.  Otherwise if you only see a single fiber optic connected horizontally to the front of the laser combiner, choose "0" (false).

== Resources ==
=== Laser Combiner questions ===
For contacting Andor product support regarding any questions, use this [http://www.andor.com/contact_us/support_request/documentation/default.aspx?product=Revolution%C2%AE%20XD Andor Product Support link]

{{Listserv_Search|Andor}}

=== Development support ===
This driver is not actively maintained by the Andor software team.
For feature requests or bug reports, please liaison with µManager developers on [[Micro-Manager_Community|the mailing list]] and Pariksheet Nanda. 



== Appendix ==
=== Setting Micro-Manager but not iQ ===
{| style="background-color:#CCFFFF;" cellpadding="10" cellspacing="0"
|valign="top"| '''Note:'''
| If you want to run Andor's iQ software as well on this computer, since iQ imposes additional restrictions on the driver versions you must use your iQ CD instead of installing the drivers from the ALC_SDK zip file.  Skip to the [[#Setting Micro-Manager alongside Andor iQ|the next section]]
|}

Specific driver versions are required.  Do not rely on the manufacturer websites for these drivers.  The ALC_SDK version 2 now bundles all the drivers you need to install to get the ALC running.  Install the drivers bundled for your flavor of Windows:

      .\ALC_REV_SDK\Drivers\

=== Setting Micro-Manager alongside Andor iQ ===
{| style="background-color:#CCFFFF;" cellpadding="10" cellspacing="0"
|valign="top"| '''Note:'''
| Windows 7 32-bit users must install >=iQ 2.4.  iQ does not support Windows 7 in earlier versions
|}

Andor completes the steps described in this section in their factory.
If you are setting up an Andor laser combiner on a new computer, only then do you need to follow this section.

When you start Windows, ignore the Found New Hardware Wizard.
Also when installing, ignore the driver requests to restart your computer.

# (Optional for testing) Dongle Driver
# [http://www.andor.com/software/iq/ Andor iQ]
#* Necessary because iQ installs the driver to recognize the DeVaSys microcontroller in the combiner
#* (Optional for testing) iQ would also serve to test that communication and control of the combiner is possible
# [http://www.mccdaq.com/software.aspx Instacal] for the Measurement Computing DAC card driver
#* Recognizes the Andor Precision Control Unit (PCU) box which controls the laser combiner Acousto-Optic Tunable Filter (AOTF)
# Prolific PL-2303 USB to RS232 driver.  '''For Windows 7 do not use Prolific's public driver.  It will lock up Windows.  Use the version bundled with the ALC SDK instead'''.
# Restart your PC
# Let Windows Found New Hardware wizard finish for all hardware
# Start menu > Measurement Computing > InstalCal, to register the PCU DAC card
#* Running InstaCal creates a new configuration file which is used by iQ
#* Simply running the program once and closing it creates the file
#* Do not delete the DEMO board.
#* Two boards should exist, the DEMO board #0 and your installed board #1
# Start Menu > Andor Bioimaging > ConfigurationManager
#* Create a new configuration with a Kinetic Dummy Camera and the Andor laser combiner

=== Mapping COM ports ===
# Remap the USB-to-Serial COM ports in your Device Manager to 201-204 or 201-206 if you have 5 or 6 lasers (Andor's library reserves these specific port numbers for the combiner, so you cannot use them for any other serial device)
# Launch the Device Manager, e.g. by (right-click) on My Computer > Manage.
# Change the Prolific USB-Serial COM ports.  See screenshot below-  by unplugging the USB cable from the front of the Andor combiner we know that Windows has enumerated the COM ports for the lasers from COM 7 to COM 10 (since these port numbers disappear from the Device manager when we unplug the combiner and reappear when we plug it back in) [[Image:AB-1-com-ports.png|frame|center||Step 1:  After restarting Windows with drivers freshly installed, the device manager can list the COM ports of the laser combiner out of order i.e. it orders alphabetically instead of numerically. In this case COM10 should not be made 201, but COM7 would be 201]] [[Image:AB-2-reassign-com-port.png|frame|center||Step 2:  Process of reassigning the COM port from COM 7 to COM 201.  (Right-click) on the port > Properties > Port Settings (tab) > Advanced > change the COM port number]] [[Image:AB-3-reassigned-scan.png|frame|center||Step 3:  After 201-204 have been resassigned, click on scan for hardware changes to refresh the window]] [[Image:AB-4-new-ports.png|frame|center||Step 4:  Result of COM port changes]]

=== Testing ===
# (Optional for testing) Now start iQ with your new laser combiner configuration and test.  The ALC_SDK also includes a test program which turns lasers on sequentially and then off:

      .\ALC_REV_SDK\Libraries\ALC_REVTest.exe
      .\ALC_REV_SDK\Libraries\ALC_REVTest64.exe

[[User:P.nanda|P.nanda]] 14:39, 29 July 2011 (PDT)
