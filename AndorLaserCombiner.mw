{| style="text-align: left"
!Summary:
|Interfaces with Andor laser combiner
|-
!Author:
|Karl Hoover, UCSF - µManager device adapter
|-
!Maintainer:
|Pariksheet Nanda, Andor - this documentation and µManager device adapter
|- valign="top"
!Contributors:
|Ed Simmons, ES Imaging - patch for GUI TTL outputs<br>Pedro Almada, documentation fixes
|-
!License:
|BSD
|- valign="top"
!Platforms:
|Windows XP 32bit<br>Windows 7 32bit and 64bit<br>(No Mac or Linux driver available)
|- valign="top"
!Devices:
|ALC-401, ALC-501<br>ALC-601 is not yet supported
|}
----



== Getting Started ==
* You need to download a copy of the Andor Laser Combiner SDK (ALC_SDK).  It is not publicly available.  To gain access to it, register/sign-into your MyAndor web account on the Andor homepage, click on Software > Downloads, uncheck the "Display only files I have access to", select "DRIVER: Andor ALC SDK 2.0" and request access.
* ALC_SDK 2.0 is the current version as of July 29, 2011

== Installing the Device Adapter ==
=== Setup the ALC_SDK ===
# [http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=11895 Download] and install VC 2008 redistributable.  The ALC_SDK library requires this.
# Unzip the ALC_SDK file
# (only for 64-bit users) Copy <code>usb2i2cio64.dll</code> installed by your DeVaSys dependency to the Micro-Manager executable folder.  This file will be installed at <code>C:\Program Files (x86)\DeVaSys\UsbI2cIo\Drivers and DLLs (32 and 64 bit)</code>
# Copy the ALC_SDK library <code>AB_ALC_REV64.dll</code> (or for 32-bit users AB_ALC_REV.dll) from the <code>Libraries</code> directory to your Micro-Manager folder.

If you already have control of your ALC in another software, your ALC_SDK installation is complete.  Otherwise continue on to [[#Configure ALC_SDK dependencies|Configure ALC_SDK dependencies]]

{{Note|iQ's FLZ can conflict with Micro-Manager's device adapter if you are not using version 1.12 of Instacal.  Specifically, if you have trouble detecting the ALC in Micro-Manager remove the DEMO-BOARD from Instacal}}

=== Configuring Micro-Manager ===
* Support for the AndorLaserCombiner was introduced in Micro-Manager 1.3.47
* During hardware setup from Tools > Hardware Configuration Wizard...
** You must add the '''AndorLaserCombiner'''.  Select "1" (true) for MultiPortUnitPresent if you have the 3 fiber optic multiport unit (MPU) controller attachment on the front of your laser combiner.  Otherwise if you only see a single fiber optic connected horizontally to the front of the laser combiner, choose the default "0" (false).
** Add '''AndorLaserCombiner Piezostage''' if your system uses Andor's analog control for piezo Z.  Generally, confocal systems have this configuration.  If you are unsure if you have this, look at the front of your Andor Precision Control Unit (PCU)- if you see a BNC connected from A5 to your Piezo Z controller, you should enable this option.
** Set the "Default shutter" as the AndorLaserCombiner
** Use the default Delay [ms] of 0.0

== Resources ==
=== Laser Combiner questions ===
For contacting Andor product support regarding any questions, use this [http://www.andor.com/contact_us/support_request/documentation/default.aspx?product=Revolution%C2%AE%20XD Andor Product Support link]

{{Listserv_Search|Andor}}

=== Development support ===
This driver is not actively maintained by the Andor software team.
For feature requests or bug reports, please liaison with µManager developers on [[Micro-Manager_Community|the mailing list]] and Pariksheet Nanda. 



== Appendix ==
=== Configure ALC_SDK dependencies ===
* Install your OS dependencies, located under the unzipped ALC_SDK's <code>Drivers</code> directory.  Under each OS folder there are folders for the 3 dependency drivers:
** DeVaSys (for front USB control to enable interlocks)
** Prolific PL-2303 USB (for laser serial communication)
** Measurement Computing (for PCI DAC card)
* The devices will be detected in the Device Manager as:
      DAS Component
         PCIM-DDA06/16
      DeVaSys USB Interfaces
         USB-I2C/IO Board
      ...
      Ports (COM & LPT)
         ...
         Prolific USB-to-Serial Comm Port
         ...
* Run Instacal from Windows Start Button > All Programs > Measurement Computing.  You will see the "Plug and Play Board Detection" window finding your PCIM-DDA06/16 card.  Click OK and Exit Instacal.  This has now written your DAC card configuration file.
* Open the Device Manager to check the COM port numbers for the USB-to-Serial COM ports built into the ALC.  Andor's library reserves specific port numbers for the combiner and expects them to be COM201-206.  Change the port numbers as follows:
** Unplug the blue USB cable from the front of the ALC and check if any such ports remain, to confirm if you have other Prolific USB-to-Serial devices attached.  If see some still left, make a note of their COM numbers so that you don't change them.  Plug the ALC back in and note the new COM numbers.
** For each of your reappeared COM ports, check the port physical location by (Right-click) > Properties.  On Windows 7, the "Port" is immediately visible under <code>Location</code> in the <code>General</code> tab.  Search the <code>Properties</code> of all the Prolific USB-to-Serial devices until you see <code>Port_#0001</code>.  That port will need to be changed to COM 201.  Note the corresponding <code>Hub_#</code> number of that port.
** Reassign your COM ports number by (Right-click) > Properties > Port Settings (tab) > Advanced > change the COM port number to 201
**  With your <code>Hub</code> number of COM 201 noted above, reassign the remaining <code>Port_#0002, Port_#0003, Port_#0004</code> for that Hub as COM 202, 203, 204 as above.
**  If your sled has 5 or 6 lasers you will be left with two more Prolific USB-to-Serial ports.  You will need to reassign <code>Port_#0002, Port_#0003</code> as COM 205 and 206, respectively
* Restart the computer to apply the COM port changes

=== Testing ===
# (Optional for testing) Now start iQ with your new laser combiner configuration and test.  The ALC_SDK also includes a test program which turns lasers on sequentially and then off:

      .\ALC_REV_SDK\Libraries\ALC_REVTest.exe
      .\ALC_REV_SDK\Libraries\ALC_REVTest64.exe

{{Devices_Sidebar}}

[[User:P.nanda|P.nanda]] 10:25, 15 August 2012 (PDT)
