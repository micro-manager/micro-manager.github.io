---
autogenerated: true
title: KDV2
redirect_from: /wiki/KDV2
layout: page
---

|                |                                                                                                                                |
|----------------|--------------------------------------------------------------------------------------------------------------------------------|
| **Summary:**   | Adapter for Focus Drive (z-stage) for Meiji Techno EMZ stereo microscopes                                                      |
| **Author:**    | Koen De Vleeschauwer, [kdvelectronics](http://www.kdvelectronics.eu)                                                           |
| **License:**   | BSD                                                                                                                            |
| **Platforms:** | All                                                                                                                            |
| **Devices:**   | [kdvelectronics Focus Drive](http://www.kdvelectronics.eu/focusdrive/FocusDrive.html) for Meiji Techno EMZ stereo microscopes. |

## Description

This adapter provides support for a z-stage for [Meiji
Techno](http://www.meijitechno.com/index1.htm) EMZ series stereo
microscopes, available from
[kdvelectronics](http://www.kdvelectronics.eu/focusdrive/FocusDrive.html).

## Installation

Installation instructions:

-   Connect and power up the focus drive.
-   Start up Micro-Manager. Open the Tools menu, and choose Hardware
    Configuration Wizard.
-   In the "Select the configuration file" window: Click on Next.
-   In the "Add or remove devices" window: Click on Add.
-   In the "Add device" window: Select "KDVZStage" from the list, then
    click on Add. A small window pops up with "Please type in the new
    device name". Click on OK. Click on Done.
-   Back in the "Add or remove devices" window: Note the list now has a
    new device called "KDVZStage" with as description "Focus Drive for
    Meiji Techno". Click on Next.
-   In the "Edit pre-initialisation settings" window: Note the serial
    port of the focus drive has the value "Undefined". Click on
    Undefined and select the serial port the focus drive is connected
    to. Click on Next.
-   In the "Setup Serial ports" window: Select the serial port the focus
    drive is connected to. Click on Next.
-   In the "Select default devices" window: Choose "KDVZStage" as
    default focus stage. Click on Next.
-   In the "Set delays for devices without synchronisation capabilities"
    window: Click on Next.
-   In the "Select devices to synchronize with image acquisition"
    window: Click on Next.
-   In the "Define position labels for state devices" window: Click on
    Next.
-   In the "Save configuration" window: Click "Save and test the new
    configuration". Click on Exit.

You can now use the focus drive in Micro-Manager.

## Properties

![](media/Kdv_focus_drive_settings.png "Kdv_focus_drive_settings.png")

The following properties are currently implemented:

StepperSpeed  
Sets the speed of the focus drive. Various settings are available from 1
revolution per minute (1 rpm) to 2 revolutions per second (2 rps). The
default value is 1 rps.

StepperIdleTimerS  
Sets the focus drive idle timer. Units are seconds. If no positioning
command has been received for more than StepperIdleTimerS seconds, the
focus drive releases the fine focus knob. A value of 0 disables the idle
timer; the focus drive never releases the fine focus knob. The default
value is 0.

StageTravelUm  
Sets the vertical travel. Units are µm. The focus drive will refuse
positioning more than StageTravelUm above or less than StageTravelUm
below the initial position at power up. The default value is 33000µm, or
33mm.

StageStepSizeUm  
Sets the focus drive step size. Units are µm. One revolution of the
focus drive equals 200 steps. The default value is 19.25µm.

StagePositioningTimeOutS  
Sets the focus drive positioning timeout. Units are seconds. The focus
drive will halt the motor if a positioning command takes more than
StagePositioningTimeOutS seconds. You may have to increase this value if
you wish to move large distances (e.g. 33mm) at very low speeds (e.g. 1
rpm). The default value is 60s.

PortTimeoutMs  
Sets the focus drive port timeout. Units are milliseconds. The focus
drive drive will report an error if the focus drive takes more than
PortTimeoutMs milliseconds to begin execution of a command. If this
error occurs, check the cable between focus drive and PC. Check the
focus drive power supply is plugged in. The default value is 1000ms, or
1 second.

## Notes

To test the stage, open the Tools menu, choose "Script Panel" and type:

```
  bsh % mmc.setRelativePosition(mmc.getFocusDevice(), 1000);
```

The stage has to move 1 mm towards the sample. Make sure that the
objective is far enough away from the sample before executing this
command.

