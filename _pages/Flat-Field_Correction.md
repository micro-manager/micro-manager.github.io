---
autogenerated: true
title: Flat-Field Correction
layout: page
---

This plugin automatically subtracts a background image and corrects for
uneven illumination based on information you provided. This plugin is
available as of version 1.4.20.2014118 and replaces the
[MultiChannelShading](MultiChannelShading "wikilink") plugin by Kurt
Thorn (in fact, its code is heavily based on that code, which in turn
was based on the code for the BFCorrector plugin).

The plugin appears as follows:

![](media/Flatfield.png "Flatfield.png")

First, using the normal Micro-Manager tools, create a Configuration
group that incorporates most things that influences what a flatfield
image looks like. This includes things such as the camera, the objective
lens, the filter cubes, and filters in the path way. Do not include
things such as binning or the ROI ofthe camera. Select this group in the
"Channel group" drop-down in the top of the plugin.

Next, create a background (dark) image. You can do so by blocking all
light from going to the camera, setting the exposure time as small as
possible and taking a time-lapse series of 100 images (make sure that
you use the full camera chip and do not use binning). Then use the
ImageJ command Image&gt;Stacks&gt;ZProject to make a mean intensity
projection. Save this image as a tiff file and specify the saved image
as the dark image.

For each flat-field preset, create a flatfield image. To do so, you can
either use plastic, fluorescent slides (such as those sold by Chroma),
or highly concentrated dye solutions (see papers by Michael Mode). Take
about 50 images (make sure that you use the full camerachip and that you
do not use binning) at different positions and calculate a median
intensity projection. Save the image as a tiff file, press the "Add"
button in the plugin, select the correct preset and locate the image you
just saved. Luckily, these settings will be remembered by the plugin.

When you now check the "Execute Flat Fielding" checkbox at the bottom of
the plugin, each acquired image will be corrected as follows:

resulting image = (acquired image - background) / (flatfield image -
background)

If you did not provide a background image, the background subtraction
will be skipped.

When you bin your image, or select a region of interest (ROI), the
plugin will automatically calculate the appropriate background and
flatfield images from the ones you provided (it is therefore important
that you collect the faltfield and background image without setting an
ROI and with a binning of 1).

Note that you can always retrieve the original data by doing the
following calculation:

acquired image = resulting image \* (flatfield image - background) +
background

