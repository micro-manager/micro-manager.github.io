---
autogenerated: true
title: AndorLaserCombiner
layout: page
---

<table>
<thead>
<tr class="header">
<th><p>Summary:</p></th>
<th><p>Interfaces with Andor laser combiner</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Author:</p></td>
<td><p>Karl Hoover, UCSF - µManager device adapter</p></td>
</tr>
<tr class="even">
<td><p>Maintainer:</p></td>
<td><p>Pariksheet Nanda, Andor - this documentation and µManager device adapter</p></td>
</tr>
<tr class="odd">
<td><p>Contributors:</p></td>
<td><p>Ed Simmons, ES Imaging - patch for GUI TTL outputs<br />
Pedro Almada, documentation fixes</p></td>
</tr>
<tr class="even">
<td><p>License:</p></td>
<td><p>BSD</p></td>
</tr>
<tr class="odd">
<td><p>Platforms:</p></td>
<td><p>Windows (No Mac or Linux driver available)</p></td>
</tr>
<tr class="even">
<td><p>Devices:</p></td>
<td><p>LC-401, LC-501, LC-601 (only 4 laser LC-601 systems supported; 5 and 6 line support possible but not yet implemented)</p></td>
</tr>
<tr class="odd">
<td><p>Since version</p></td>
<td><p>1.3.47</p></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

## Installation

In most cases the ALC will work "out of the box".

But if you're setting up a brand new computer, continue on to
[\#Configure ALC\_SDK
dependencies](#Configure_ALC_SDK_dependencies "wikilink"), and for
Micro-Manager versions than nightly build 1.4.16\_20131025 follow the
[\#Library installation for MM 1.4.15 and
earlier](#Library_installation_for_MM_1.4.15_and_earlier "wikilink").

## Hardware-based Synchronization

[ESIOImagingControllers](ESIOImagingControllers "wikilink") can be used
with an ESio adapter cable for the ALC to run [hardware-based
synchronization](hardware-based_synchronization "wikilink"). The ALC
lacks the onboard programming to allow the camera TTL synchronization
used by the Micro-Manager architecture, thus another supported
triggering device is needed.

## Hardware Configuration Wizard

Description of devices available in the Hardware Configuration Wizard:

| Available Devices  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|--------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AndorLaserCombiner | Main device required for your hardware configuration.                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Piezostage         | Enable Andor's analog BNC control for your Piezo Z device. Generally, confocal systems have this configuration since it moves the Piezo faster than RS-232 serial control. If you are unsure about this, look at the front of your Andor Precision Control Unit (PCU)- if you see a BNC cable connected from A5 of the PCU to your Piezo Z controller, you should enable this option. If you see the A5 BNC sealed off, you have a 6 laser system that therefore does not have this feature. |

| Initialization Properties | Description                                                                                                                                                                                                        |
|---------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| MultiPortUnitPresent      | Leave as the default "0" (false) if you only see a single fiber optic connected horizontally to the front of the laser combiner. Otherwise select "1" (true) if you see the multi fiber optic switcher attachment. |

For `Auto-Shutter` setting in Step 3 of 6, set the `Default Shutter` to
the `AndorLaserCombiner` and in Step 4 of 6 use the default `Delay [ms]`
of `0.0` since a fast AOTF gates the laser output.

## Device Properties

| Property          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Enable            | Logical shutter to allow selection of laser line. It can also set the laser to TTL mode, if the laser supports it. TTL mode requires firmware 2. When creating laser imaging channels, you should add the `Enable` properties for each laser wavelength to turn on only the wavelength(s) you need.                                                                                                                                                                                                          |
| SaveLifetime      | Allows lasers to be put in standby mode to preserve lifetime hours. Changes to this property are saved onto the device memory, so the setting is persistently between Micro-Manager sessions. Since going into and coming out of standby can take a few seconds, best practice is leave this property "global" by not including it in channels. Instead, one could add these properties to the `System` `Startup` preset, or just create shortcuts by creating groups with only the SaveLifetime setting(s). |
| IsLinear          | Reads whether linear correction algorithm is being applied to AOTF by `PowerSetpoint`, otherwise AOTF laser power output is sigmoid.                                                                                                                                                                                                                                                                                                                                                                         |
| PowerSetpoint     | AOTF intensity setting. Actual power output may or may not be linear depending on the value of `IsLinear`.                                                                                                                                                                                                                                                                                                                                                                                                   |
| PowerReadback     | Current laser head power output. Output of 0, could be due to laser being put in Standby using SaveLifetime, or a fault with the laser head. If power is more than a few percent lower than MaximumLaserPower, it also indicates a faulty laser head, but some lasers can take up to 5 minutes to warm up (most warm up in 2 minutes).                                                                                                                                                                       |
| MaximumLaserPower | Laser rated operating power in milli-Watts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Hours             | Indicates laser expired life to plan warranty contracts. (Unfortunately this always shows a value of "0" because the feature is not yet implemented by the Andor ALC SDK)                                                                                                                                                                                                                                                                                                                                    |
| WaveLength        | Wavelength of laser line.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| LaserState        | Laser state: "0" indicates off, "1" warm up (if `SaveLifetime` is set to "PowerOn") or standby (if `SaveLifetime` is set to "Standby"), and "2" is stable output.                                                                                                                                                                                                                                                                                                                                            |
| NLasers           | Number of lasers available.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| LaserPort         | Multi fiber port unit control.                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DOUT              | Digital 8-bit output from Precision Control Unit. The lowest 2 bits are not accessible if a multi fiber port unit is present.                                                                                                                                                                                                                                                                                                                                                                                |
| DIN               | Digital 8-bit input from Precision Control Unit. Reads TTL input signal state.                                                                                                                                                                                                                                                                                                                                                                                                                               |

## Troubleshooting (known issues and fixes)

### No laser, but laser emission LEDs are illuminated

| Description | The hardware appears to be operating correctly, but there is no laser output. The camera is running live, feeding the Active Blanking signal. |
|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| Cause       | DEMO-BOARD device listed in InstaCal                                                                                                          |
| Workaround  | Delete the DEMO-BOARD device by opening InstaCal from `Start Menu > Programs > Measurement Computing`                                         |

### Microsoft Visual C++ error(s) opening HCW

| Description | Opening the `Hardware Configuration Wizard` shows one or more of the following error windows, and closing the window immediately crashes µManager: ![Figure: Error due to incorrect internal laser power setting](media/Alc_mscv_error.jpg "fig:Figure: Error due to incorrect internal laser power setting") |
|-------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Cause       | Bug in ALC\_SDK (Laser power setting exceeding rated value)                                                                                                                                                                                                                                             |
| Workaround  | Request Andor support to remotely connect to each laser head and adjust the "set power" (using the `p=` serial command) to the rated value of the laser head.                                                                                                                                           |

### Hang due to USB power saving

| Description | Micro-Manager hangs during acquisition.                                                                 |
|-------------|---------------------------------------------------------------------------------------------------------|
| Cause       | Windows Vista and newer enable USB power saving, even in the "High Performance" power plan, by default. |
| Fix         | [Disable Windows "USB selective suspend setting"](Personal_computer_setup#Power_Options "wikilink").    |

### Hang due to incorrect Prolific USB-Serial driver

<table>
<thead>
<tr class="header">
<th><p>Description</p></th>
<th><p>Micro-Manager hangs during acquisition.</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>Cause</p></td>
<td><p>Buggy Prolific driver (version 3) bundled by Windows 7. In the Device Manager when you right-click on the Prolific serial port:</p>
<p><code>  Ports (COM &amp; LPT)</code><br />
<code>        ...</code><br />
<code>        Prolific USB-to-Serial Comm Port (COM201)</code><br />
<code>        ...</code></p>
<p>... it will show a newer driver version than 2.0.13.130.</p></td>
</tr>
<tr class="even">
<td><p>Workaround</p></td>
<td><ol>
<li>Install Prolific driver <a href=":File:media/PL2303_DriverInstaller_v1413_20110219.gz" title="wikilink">version 2.0.13.130</a></li>
<li>Disable Microsoft server driver installation. When Windows says it's searching for drivers, it fetches them from the Microsoft server. Turn off this driver updating behavior because if e.g. the USB bus glitches for whatever reason it will try to reinstall the buggy version 3 drivers (you have to do this step even if you have Windows updates disabled) via the Start menu &gt; (Type in the "Search programs and files" box) change dev &gt; Change device installation settings &gt; No, Let me choose what to do &gt; Never install driver from Windows Update</li>
<li>In your Device Manager, right-click on the Prolific ports and check the driver version. The good version is 2.0.13.130. Most likely you will see something like 3.4.48.272. Right-click on the Prolfic entry in the Device Manager &gt; Uninstall &gt; Delete the driver software for this device &gt; OK. Repeat for all Prolific COM20x ports. Then to pick up the next available driver in Windows, in the Device Manager click Action &gt; Scan for hardware changes). Until you get 2.0.13.130, repeat the above of uninstall+deleting the driver. You will then need to reassign the COM ports to 20x which is detailed in <a href="AndorLaserCombiner#Configure_ALC_SDK_dependencies" title="wikilink">AndorLaserCombiner#Configure_ALC_SDK_dependencies</a>.</li>
</ol>
<p>{% include Note text="Andor's ALCs have since switched to using FTDI USB-serial convertors because Prolific considers the PL-2303 an obsolete product and Prolific won't fix the issue with Microsoft distributing faulty drivers." %}</p></td>
</tr>
</tbody>
</table>

## Resources

### Laser Combiner questions

For contacting Andor product support regarding any questions, use this
[Andor Product Support
link](http://www.andor.com/contact_us/support_request/documentation/default.aspx?product=Revolution%C2%AE%20XD)

{% include Listserv_Search text="Andor" %}

### Development support

This driver is not actively maintained by the Andor software team. For
feature requests or bug reports, please liaison with µManager developers
on [the mailing list](Micro-Manager_Community "wikilink") and Pariksheet
Nanda.

## Appendix

### Library installation for MM 1.4.15 and earlier

-   In older versions of Micro-Manager, the ALC\_SDK library files were
    not included in the main Micro-Manager directory. For convience the
    files have been uploaded (with permission) to this wiki:

<table>
<thead>
<tr class="header">
<th></th>
<th><p>ALC Driver Pack</p></th>
<th><p>Visual C++ 2008 redist<br />
(Only for MM 1.4.14 and earlier)</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>32-bit</p></td>
<td><p><a href=":File:libalc_x86.Tar.gz" title="wikilink">ALC_SDK Libraries 2.0 (32-bit)</a></p></td>
<td><p><a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=11895">vcredist_x86.exe</a></p></td>
</tr>
<tr class="even">
<td><p>64-bit</p></td>
<td><p><a href=":File:libalc_x64.Tar.gz" title="wikilink">ALC_SDK Libraries 2.0 (64-bit)</a></p></td>
<td><p><a href="http://www.microsoft.com/download/en/details.aspx?displaylang=en&amp;id=11895">vcredist_x64.exe</a></p></td>
</tr>
</tbody>
</table>

-   Unzip the `ALC_SDK Libraries` to a new folder and [add it to the
    Windows
    PATH](Personal_computer_setup#Add_device_libraries_to_Windows_PATH "wikilink"):

```
         C:\ProgramData\Andor_ALC_library\
```

-   If you already have control of your ALC in another software, your
    ALC\_SDK installation is complete because all the Windows device
    drivers would be installed. Otherwise continue on to [\#Configure
    ALC\_SDK dependencies](#Configure_ALC_SDK_dependencies "wikilink").

### Configure ALC\_SDK dependencies

-   There are 3 dependency drivers:
    -   DeVaSys (for front USB control to enable interlocks)
    -   Prolific PL-2303 USB (for laser serial communication). On the
        ALC-601 these have been replaced with standard Tronix FTDI
        drivers which don't require driver installation as they are
        bundled with Windows 7.
    -   Measurement Computing (for PCI DAC card)

  
Install them from:

| OS version | DeVaSys                                                                                                   | Prolific                                                                         | Measurement Computing                                                             |
|------------|-----------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| 32-bit     | [UsbI2cIo 5.00 (32-bit)](http://devasys.net/support/current/usbi2cio/software/UsbI2cIoDrivers0500x86.msi) | [Prolific 2.0.13.130](:File:media/PL2303_DriverInstaller_v1413_20110219.gz "wikilink") | [InstaCal 6.10](ftp://ftp.mccdaq.com/Archive/InstaCal/Archive_6.10/icalsetup.exe) |
| 64-bit     | [UsbI2cIo 5.00 (64-bit)](http://devasys.net/support/current/usbi2cio/software/UsbI2cIoDrivers0500x64.msi) |                                                                                  |                                                                                   |

-   The devices will be detected in the Device Manager as:

```
     DAS Component
        PCIM-DDA06/16
     DeVaSys USB Interfaces
        USB-I2C/IO Board
     ...
     Ports (COM & LPT)
        ...
        Prolific USB-to-Serial Comm Port
        ...
```

-   Run Instacal from Windows Start Button &gt; All Programs &gt;
    Measurement Computing. You will see the "Plug and Play Board
    Detection" window finding your PCIM-DDA06/16 card. Click OK and Exit
    Instacal. This has now written your DAC card configuration file.
-   Open the Device Manager to check the COM port numbers for the
    USB-to-Serial COM ports built into the ALC. Andor's library reserves
    specific port numbers for the combiner and expects them to be
    COM201-206. Change the port numbers as follows:
    -   Unplug the blue USB cable from the front of the ALC and check if
        any such ports remain, to confirm if you have other Prolific
        USB-to-Serial devices attached. If see some still left, make a
        note of their COM numbers so that you don't change them. Plug
        the ALC back in and note the new COM numbers.
    -   For each of your reappeared COM ports, check the port physical
        location by (Right-click) &gt; Properties. On Windows 7, the
        "Port" is immediately visible under `Location` in the `General`
        tab. Search the `Properties` of all the Prolific USB-to-Serial
        devices until you see `Port_#0001`. That port will need to be
        changed to COM 201. Note the corresponding `Hub_#` number of
        that port.
    -   Reassign your COM ports number by (Right-click) &gt;
        Properties &gt; Port Settings (tab) &gt; Advanced &gt; change
        the COM port number to 201
    -   With your `Hub` number of COM 201 noted above, reassign the
        remaining `Port_#0002, Port_#0003, Port_#0004` for that Hub as
        COM 202, 203, 204 as above.
    -   If your sled has 5 or 6 lasers you will be left with two more
        Prolific USB-to-Serial ports. You will need to reassign
        `Port_#0002, Port_#0003` as COM 205 and 206, respectively
-   Restart the computer to apply the COM port changes

