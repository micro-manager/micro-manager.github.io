Micro-Manager has a Java-based plugin system similar to ImageJ's. To write a Micro-Manager plugin, simply implement the [https://valelab.ucsf.edu/svn/micromanager2/branches/micromanager1.3/mmstudio/src/org/micromanager/api/MMPlugin.java <code>MMPlugin</code> interface]. {{Note|The static String <code>menuName</code> lets you control the name of the plugin that appears in the Micro-Manager Plugins menu.}}

Micro-Manager's classpath is set up so that Micro-Manager plugins can import classes from:
# the [http://java.sun.com/j2se/1.6.0/docs/api/ Java 2 SE 6.0 Libraries]
# [https://valelab.ucsf.edu/~arthur/mm_doc/html/namespaces.html Micro-Manager]
# [http://rsbweb.nih.gov/ij/developer/api/ ImageJ]
# [http://commons.apache.org/math/userguide/overview.html Apache Commons Math]

The MMPlugins API provides you access to the GUI and core instances (objects) already created by Micro-Manager startup. Micro-Manager will call
<code>public void setApp(ScriptInterface app);</code>
you can get the GUI object, core and acquisition engine objects thus:
<div class="source">
    MMStudioMainFrame gui_ = (MMStudioMainFrame) app;
    CMMCore core_ = gui_.getMMCore();
    AcquisitionEngine acq_ = gui_.getAcquisitionEngine();
</div>

Once you have compiled your code into a <code>.class</code> file or a <code>.jar</code> file, drop that file into Micro-Manager's <code>mmplugins</code> directory, and it will be loaded at startup.

The source code for a number of Micro-Manager plugins is publicly available [https://valelab.ucsf.edu/svn/micromanager2/branches/micromanager1.3/plugins/ here].


=== Using Netbeans ===

The dynamic loading feature (described above) is useful if you are developing your plugin using an IDE such as Eclipse or Netbeans. (The Micro-Manager distribution includes <code>swing-layout-*.*.jar</code> so that you can use the free Netbeans GUI Builder for your plugin.) Here are the steps for Netbeans:
# Install [http://netbeans.org Netbeans]. Note, Netbeans currently comes with the Java 1.7.0 run time environment. After install, you will need to manually install and add the JRE that Micro-Manager uses: 1.6.0, 64-bit if you need it.
# Select New > New Project... > Java > Java Class Library.
# Name your plugin project and press Finish.
# Under the Projects tab, right-click your plugin project and choose Properties.
# Then choose Libraries > Compile > Add JAR/Folder.
## Browse to <code>C:\Program Files\Micro-Manager-1.4\plugins\Micro-Manager</code> and choose all jars in that directory.
## Click Add JAR/Folder again and add <code>C:\Program Files\Micro-Manager-1.4\ij.jar</code>
## Click Categories > Run and set Main Class to <code>ij.ImageJ</code>, working directory to <code>C:\Program Files\Micro-Manager-1.4\</code> . Click OK.
# Now choose Debug > Debug Project from the Menu and ImageJ/Micro-Manager should launch. Close it for now.
# Right-click your Source Packages in your project, under the Projects tab. Select New > Java Class... and give your plugin a class name and package name.
# Edit the class declaration so that it contains the phrase <code>implements org.micromanager.api.MMPlugin</code>. Left-click on the light-bulb with a red pimple to the left of this line, and select "Implement all abstract methods."
# Compile your project, and manually copy the project jar file to Micro-Manager's <code>mmplugins</code> directory. Alternatively, you can add the following to your project <code>build.xml</code> file (look in the Project "Files" tab in Netbeans):
<div class="source">
        <property name="pluginsDir"  location="C:\Program Files\Micro-Manager-1.4\mmplugins" />
        <target name="-post-jar">
        System.out.println(info);
        <echo message="--Copied MM plugin JAR to basedir: ${basedir}" />
        <copy file="${basedir}/${dist.jar}" toDir="${pluginsDir}" />
        </target>
</div>
:When "Clean and Build" is run, this will automatically copy the current version of your plugin to the <code>mmplugins</code> folder.
<ol><li value=10>Now choose Debug > Debug Project and your nascent plugin should appear in the Plugins menu.</li></ol>
:You can also dynamically load your plugin by including a line in the <code>MMStartup.bsh</code> file. (This file should reside in the root directory of your Micro-Manager installation; if there isn't one yet, you can create it with any text editor program.) For example:
<div class="source">
        gui.installPlugin("org.micromanager.surveyor.SurveyorPlugin");
</div>
:Make sure you change the "Layout Generation Style" property from "Automatic" to "Swing Layout Extensions Library" as explained on the [http://wiki.netbeans.org/FaqFormLayoutGenerationStyle Netbeans website].

{{Programming_Sidebar}}
