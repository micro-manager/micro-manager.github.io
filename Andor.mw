{| style="text-align: left"
!Summary:
|Interfaces with Andor cameras
|- valign="top"
!Authors:
| Nenad Amodaj (Windows)<br>Karl Bellv&eacute; (Linux port)<br>Jizhen Zhao, Daigang Wen, Francis McCloy (Andor contributors)
|- valign="top"
!Maintainers:
|Matt Milford (Andor)<br>David Gault (Andor - retired)<br>Arthur Edelstein<br>Karl Bellv&eacute; (Linux port)<br>Pariksheet Nanda (Andor) this document
|-
!License:
|BSD
|-
!Platforms:
|Windows and Linux (No Mac driver available)
|- valign="top"
!Devices:
|iXon Ultra, iXon3, iXon+, iXon<br>Luca-S, Luca-R<br>Clara, Clara-E
|}
----

== Installation ==
=== Andor SDK ===
You must install the Andor SDK, or Andor camera application software (Solis or iQ), since it contains the necessary files to recognize the camera.  If you need to download a copy of the Andor SDK, since is not publicly available, request [[#Andor support|Andor support]] to gain access to it, stating in the support request form you need the drivers for µManager.

==== Windows 7 64-bit driver signing error ====
{| class="wikitable"
!Solution
|Use Andor SDK to 2.94 or later
|-valign="top"
!Affected versions
|Andor SDK < 2.94
|-
!Andor bug number
|6660
|}

=== Disable power savings ===
Commercial computers like Dell, HP, etc shipped in the US and Europe are legally required by environmental regulations to ship with all power savings turned on.  These must be disabled in the BIOS.

Additionally for Windows 7, turn off [http://www.austinblanco.com/blog/?p=818 PCI power management and USB suspend] settings

=== Test communication ===
The Andor SDK installs test programs that can be used to get live images:

      C:\Program Files\Andor SOLIS\Drivers\Examples\C\

=== Fixing computer bus speed bottlenecks ===
==== PCIe ====
iXon PCIe cameras can have their live stream stops after 2 or 3 images or not start at all.  The reason for this is PC motherboards throttle the PCIe speed depending on the daughter boards populated.  Make sure you plug the PCIe card into a fast enough bus.

For example the Dell XPS desktop 1x PCIe bus will not run at the rated speed when the PCIe 16x graphics card is populated, so you have to instead connect the Andor PCIe card to 8x PCIe slot

==== PCI ====
iXon 885 PCI cameras can have their live stream not start at all, but will work if you bin the image 2x2 or slow the horizontal clock speed from 35MHz to 13MHz.  The reason for this is a small set of PC motherboards may not fully comply with the PCI standard bandwidth, so try another motherboard (or more conveniently another computer)

==== USB ====
USB cameras using high bandwidth such as the Clara must be plugged into the computer to be its own USB bus:

'''Windows O/S'''

You need to use a utility like [http://www.ftdichip.com/Resources/Utilities/usbview.zip UVCview] to inspect the USB bus.  Try different USB slot positions on the computer until the camera is on its own USB bus.

Screenshot below of UVCview on Windows showing the Clara by itself on the USB bus, i.e. with no other devices sharing it:
[[Image:Good_Clara_USB_Connection cropped.JPG|frame|center]]

'''Linux O/S'''

You can easily check USB bus position with '''lsusb -t'''.  
The shell output below shows that the Clara (Vendor 0x136e Product 0x000e) has been correctly plugged into its own USB bus (Bus# 1):

      $ lsusb -t
      Bus#  5
      `-Dev#   1 Vendor 0x1d6b Product 0x0001
      Bus#  4
      `-Dev#   1 Vendor 0x1d6b Product 0x0001
        |-Dev#   2 Vendor 0x046d Product 0xc045
        `-Dev#   3 Vendor 0x2341 Product 0x0001
      Bus#  3
      `-Dev#   1 Vendor 0x1d6b Product 0x0001
        `-Dev#   2 Vendor 0x03f9 Product 0x0100
      Bus#  2
      `-Dev#   1 Vendor 0x1d6b Product 0x0001
      Bus#  1
      `-Dev#   1 Vendor 0x1d6b Product 0x0002
        `-Dev#   6 Vendor 0x136e Product 0x000e

      $ lsusb
      Bus 005 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
      Bus 004 Device 002: ID 046d:c045 Logitech, Inc. Optical Mouse
      Bus 004 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
      Bus 003 Device 002: ID 03f9:0100 KeyTronic Corp. Keyboard
      Bus 003 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
      Bus 002 Device 001: ID 1d6b:0001 Linux Foundation 1.1 root hub
      Bus 001 Device 006: ID 136e:000e  
      Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub

== Device Configuration ==
# Open Micromanager.
# You will be prompted to load a configuration file.  To create a new configuration file use "Tools" > "Hardware Configuration Wizard..." to manually add the device.

=== Suggested Presets ===
iXon camera:

{| class="wikitable"
!style="width: 20%;"| Preset Name
! Frame Transfer
! Output Amplifier
! Pre-Amp Gain
! Readout Mode
! Vertical Speed
! Vertical Clock Voltage
|-
! EM high sensitivity
| Off
| Electron Multiplying
| <highest>
| <highest>
| 1.70 (microseconds)
| Normal
|-
! EM high speed burst mode
| On
| Electron Multiplying
| <highest>
| <highest>
| 0.30 (microseconds)
| <highest>
|-
! CCD high sensitivity
| Off
| Conventional
| <highest>
| <highest>
| 1.70 (microseconds)
| Normal
|-
! CCD high capacity
| Off
| Conventional
| <lowest>
| <highest>
| 1.70 (microseconds)
| Normal
|}



== Device Settings ==

=== Cooling ===
* iXon cameras MUST be cooled to the specified temperature: at least -60 C for DV models and -70 C for DU models. 
* Offset ("Baseline") is optimal at this setting.  If the camera is not cooled, the offset can be display as 0 data counts.
* Some blemishes are compensated at the specified temperature setting and will be more visible at warmer temperatures. 
* No need to warm up cameras before shutdown of software and computer (since condensation does not occur). 
* Full gain will not be achievable without cooling. 
* EMgain is temperature compensated for RealGain cameras. 
* Clara must be cooled to the specified temperature: -45 C with fan, -15 C without.  The Clara-E is fixed at cooling to -20 C, so no action is needed to set its temperature

=== Pre-Amplifier Gain (PAG) ===
* It's best to think of Pre-Amplifier Gain as follows:
*:4x = High sensitivity mode (use for EM gain)
*:2x = Intermediate sensitivity / capacity mode
*:1x = High capacity mode
*:
{{Note|For EMCCDs, Andor's nomenclature of PAG is confusing since one may think this "pre-" amplification happens before EM gain amplification.  In reality, EM amplification happens on sensor, and PAG happens after readout of your sensor and before digitization.}}
* PAG multipliers like 1x, 2x, 4x can vary between cameras since they are tuned for each sensor, e.g. for a particular camera the values could be 1x, 2.4x, 4.9x
* PAG can affect the saturation limit of your image.  To determine the expected digital saturation limit, consult your camera performance sheet of your camera.  Divide the "Saturation Signal per Pixel (Electrons/pixel)" by the "CCD Sensitivity (Electrons/A2D count)" to get saturation signal in digital counts.

{{MessageBox|Warning|Always set PAG to maximum "High sensitivity mode" when using EM gain.  Lower settings of PAG is useful in Life Sciences only in Conventional (non-EM) mode}}

=== Electron Multiplying Gain (EM Gain) ===
==== EMgain range ====
* EMgain does not start at 1 for all cameras.  The start level is tuned for each EMCCD chip. 
* The actual EM gain range depends on the model of your camera: it can be from 0 to 255 (non-linear), 4096 (non-linear), or RealGain 1000 (linear)

==== EMgain slew rate ====
{{MessageBox|Warning|Typically EM gain levels should not be made to change during an experiment.
The software and camera has no problem in changing the level, but there is a 1-3 second delay for the new gain value to come into effect which affects data.}}

e.g. if you are imaging confocal fluorescence data and DIC, and you need lower or no EM gain for DIC, one would need a 3 second delay before and after the DIC image to allow for EM gain to slew.
|}
* iXon, iXon+, Luca-R and Luca-S
* EM gain circuitry is powered by a high +53V voltage rail and the gain applied to the EM readout register is proportional to this voltage.
* Thus when you increase or decrease the EM gain on the camera, you have to wait for the voltage slew to stabilize at the new set value.
* This is typically about 1-2 seconds, the maximum time being from setting EM gain from 0 to the maximum value of 1000. 
* Thus it is much better to vary exposure times or excitation signal intensity rather than switching EM gain levels in a multi-channel acquisition (unless you know what you are doing)

==== iXon Conventional CCD or EM-CCD mode ====
* With the exception of the 885, you can switch between CCD and EMCCD modes via the Output_Amplifier setting
* EMCCD readout without EM gain is more noisy (~40e read noise) so Conventional readout (~6e read noise) is beneficial if light levels do not require EM gain.
* Benefits of EM gain combating the EMCCD readout register noise of ~40e can be seen from 45x onward, i.e it is better to use 45x EM gain and upward.

=== iCam ===
* Allows for [http://www.andor.com/software/icam/ rapid switching of exposure times] in multi-channel acquisitions.
* µManager needs to implement SequenceExposure functions to use this feature.  No camera DeviceAdapter implements this yet.

== Troubleshooting ==

=== Check for device driver ===
Make sure there is no yellow question mark next to the device, and that it is present in the Device Manager.

{| class="wikitable"
! Device Type
! Appearance in Device Manager
|-
| PCI/PCIe
|
 Andor
  \- Andor Technology PCI{e} driver
|-
| USB
|
 LibUSB-Win32 Devices
  \- Andor {Clara, Luca, iXon Ultra}
|}

If there is a yellow question mark, then right-click on the device, update the driver and choose:

{| class="wikitable"
! OS
! Action
|-
| Windows 7
|
 Browse my Computer for driver software >
|-
| Windows XP
|
 Install from a list or specific location (Advanced) >
 Search for the best driver in these locations >
 Include this location in the search >
|}

...and use the path below according to the software you have installed:

{| class="wikitable"
! Software
! Path containing Andor device driver
|-
| Andor SDK
| C:\Program Files\Andor SOLIS\Drivers\
|-
| Andor Solis
| C:\Program Files\Andor SOLIS\
|-
| Andor iQ
| C:\Program Files (x86)\Andor Bioimaging\Common Files\Drivers\
|}


=== Updating Andor library (DLL) ===
If Micro-Manager's Andor library is too old, adding (i.e. initializing) your Andor camera in the Hardware configuration wizard can result in:
* Error code 22
* Micro-Manager crash (with no error in the CoreLog)

To fix this, update the Andor library used by Micromanager by copying the library file from your Andor software to your Micro-Manager installation directory.  The name of the Andor library needed is '''atmcd32d.dll''' or '''atmcd64d.dll''', depending if whether are using 32- or 64-bit Micro-Manager.  The default location of the Andor library installed varies with the software you are using:

{| class="wikitable"
! Software
! Path containing Andor library
|-
| Andor SDK
| C:\Program Files\Andor SOLIS\Drivers\
|-
| Andor Solis
| C:\Program Files\Andor SOLIS\
|-
| Andor iQ
| Not applicable since iQ uses a C++ interface wrapper to combine SDK2 and SDK3
|-
| MDS Metamorph 7
| C:\MM\vinput\andor\
|}

=== iXon [https://gist.github.com/omsai/4694420/raw/f39715c6b49afe9266fe131f357d581d20890efa/gistfile1.txt Error 20010 DRV_ERROR_PAGELOCK] ===
{| class="wikitable"
!Solution
|
# Uninstall the existing device driver for the Andor PCI/e framegrabber card:
#* The following Microsoft guide explains who to do this, but there is no need to physically remove the card as described in step 6 of the Uninstall section:
#*: http://technet.microsoft.com/en-us/library/cc725782.aspx#bkmk_2
#* When uninstalling, make sure to select <code>Delete the driver software for this device</code>.
#* Use <code>Scan for Hardware Changes</code> Action in the Device Manager as described in the guide.  If it finds the driver, repeat this uninstall process until all copies of the driver are deleted.
# Upgrade to Andor camera SDK 2.94.30007.0 or later.
# Windows now uses the new <code>sys</code> file.
|-valign="top"
!Nightly build<br>containing fix
|N/A - this is an Windows driver bug with the Andor <code>sys</code> file, not µManager
|-
!Affected versions
|Andor SDK 2.93 and earlier (Windows-only bug)
|-
!Andor bug number
|6659
|}

=== iXon [http://micro-manager.3463995.n2.nabble.com/Propblems-setting-the-Pre-Amp-Gain-with-Ixon897-td7579735.html Pre-Amp-Gain Error Code 3] ===
{| class="wikitable"
!Solution
|Upgrade µManager
|-valign="top"
!Nightly build<br>containing fix
|1.4.15_20130430
|-valign="top"
!Affected versions
|Upto 1.4.14
|-
!Andor bug number
|8164
|}

=== Clara [http://micro-manager.3463995.n2.nabble.com/Problems-with-Andor-Clara-and-MM-1-4-7-Error-code-20066-4e62hex-td7272537.html Error 20066 PreAmp selection] ===
{| class="wikitable"
!Solution
|Upgrade µManager
|-valign="top"
!Nightly build<br>containing fix
|1.4.11_20121014
|-valign="top"
!Affected versions
|1.4.7 to 1.4.11
|-
!Andor bug number
|7187
|-
!Workaround
|Copy Andor SDK 2.90.30004.0 or older DLL to µManager directory
|}

=== Luca [http://micro-manager.3463995.n2.nabble.com/Error-message-90991-51ff-hex-td7578217.html Error 20991] ===
{| class="wikitable"
!Solution
|Upgrade µManager
|-valign="top"
!Nightly build<br>containing fix
|1.4.11_20121019
|-
!Affected versions
|1.4.9 to 1.4.11
|-
!Andor bug number
|7162
|-
!Workaround
|Copy Andor SDK 2.88.30002.0 or older DLL to µManager directory
|}

== Resources ==

=== Development support ===
Please liaison with Micro-Manager developers to contact the Andor software team

{{Listserv_Search|Andor}}

=== Andor support ===
For contacting Andor product support regarding any questions, see under "Support" for your location -
http://www.andor.com/contact_us/default.aspx

{{Devices_Sidebar}}
