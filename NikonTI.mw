== Nikon Ti motorized microscope ==

<table><tr><td>
'''Summary:'''</td><td>Adapter for Nikon Ti motorized microscopes</td></tr>
<tr><td>'''Author:'''</td><td>Nico Stuurman and Roy Wollman<br>Karl Hoover (additional accessory devices, Matlab compatibility & maintenance)</td></tr>
<tr><td>'''License:'''</td><td>Source code cannot be made available</td></tr> 
<tr><td>'''Platforms:'''</td><td>Windows only (uses driver supplied by Nikon)</td></tr>
<tr><td valign='top'>'''Devices:'''</td><td>TIScope, NosePiece, Shutter, Epi-Shutter, Optical Path, FilterBlockCassette,  Focus (z-drive), PerfectFocus, XYStage, HalogenLamp, TIRF attachment</td></tr>
<tr><td width=20%>'''Since version'''</td><td>1.2.18</td></tr>

<tr><td><b>Peripheral device discovery:</b></td><td>Supported</td></tr>
</table>


This adapter communicates to all the devices in the Ti through the TIScope hub device.  Thus, to use any of these devices, you will need to first define the TIScope device.   

== Installation ==

This adapter uses the driver and API supplied by Nikon. The latest version of Ti Setup Tool (which includes drivers for the Ti microscope and TiControl, a control and configuration utility) can be downloaded from the [http://www.nikon-instruments.jp/eng/service/download/DLList.aspx?CID=3  Nikon website]. However, as of this writing (July 2013), it looks like Nikon has not been updating Ti Setup Tool with the latest driver and interface library DLLs since 2011.

The required Nikon driver and interface libraries (a.k.a. the redistributable components of the Nikon Ti SDK) can also be installed using our own ('''experimental''') installer:

{| class="wikitable"
! SDK Version
! 32-bit Installer !! 32-bit Driver Version
! 64-bit Installer !! 64-bit Driver Version
|-
| 4.2.3.572
| N/A || 2.0.2.1
| N/A || 2.0.2.1
|-
| 4.3.2.622
| N/A || 2.0.2.1
| N/A || 2.0.2.2
|-
| 4.3.3.628
| N/A || 2.0.2.1
| N/A || 2.0.2.2
|-
| 4.4.1.672
| [[Media:TiSDKRedist32-4.4.1.672.zip|32-bit 4.4.1.672]]<br />(updated July 3, 2013) || 2.0.2.1
| [[Media:TiSDKRedist64-4.4.1.672.zip|64-bit 4.4.1.672]]<br />(updated July 3, 2013) || 2.0.5.1
|-
| 4.4.1.714
| Forthcoming || 2.0.5.1
| Forthcoming || 2.0.5.1
|}

After installing one of these, you will need to tell Windows to use the new driver by opening the Windows '''Device Manager''', finding the Nikon Ti microscope (under Imaging Devices), and choosing Properties from the right-click menu. Click '''Update Driver''' and tell Windows to search C:\Program Files\Nikon\Shared\Drivers (or the appropriate equivalent on your system). Note that the driver version number differs from the SDK and library (DLL) version numbers (the main DLL is normally installed at C:\Program Files\Nikon\Shared\Bin\NikonTi.dll). To '''uninstall''' any of these packages, go to the Programs and Features control panel; the package should be listed with Micro-Manager as Publisher and you can right-click to uninstall.

Whichever way you install the drivers, it is best to uninstall any previously installed version, so that you are sure you are using the version you installed (especially if you are troubleshooting). This is not absolutely necessary when upgrading, but to revert to an older version of the driver and DLLs, you need to uninstall all packages that include them.

== Device-specific notes ==

Support for control of the HalogenLamp ('DiaLamp') was added in version 1.3.18.  The Halogenlamp cannot be controlled simultaneously using the dial and button on the scope and through the computer.  To switch between manual and computer control use the property 'ComputerControl'.  Lamp intensities set through manual control and through computer control are completely independent (i.e., when setting lamp intensity using the dial on the scope and switching to computer control, light intensity will be different). 

It is possible to control the IntensiLight epi-fluorescence light source shutter.  If you want to control the IntensiLight with Micro-Manager, you can either connect it directly to the computer, or you can attach it to the Nikon Ti controller.  In the latter case, you will need to go into TiControl -> setting, click on "Connection", select the left most icon, set the connected shutter to IntensiLight and type to Epi (I had mine attached to shutter 2).  Now, you can control the shutter with the Epi Shutter button on the microscope.  You can now use the EpiShutter Nikon Ti device in Micro-Manager to control the IntensiLight shutter.  Note that you will not be able to control the ND filters this way.

The tube lens switcher of the Nikon Ti is not encoded (the computer has no way of knowing its state).  You can encode the tube lens switcher yourself following these instructions: [[Encoding_the_Nikon_TI_Eclipse_tube_lens]].

In our experience, movement of the dichroic turret (Filter Block Cassette) causes significant vibrations in the microscope.  This results in blurry images.  To avoid this, add a delay (step 4 of the hardware configuration wizard) to the FilterBlock device.  A delay of 250 msec seems to work well.  

{{Listserv_Search|Nikon}}

{{Devices_Sidebar}}
